---
import { Image } from "astro:assets";
import lb from "../assets/R.png";
import rb from "../assets/rb.png";
import profile from "../assets/profile.jpg";
import Separator from "./Separator.astro";

const path = Astro.url.pathname;
const redNeonBorder =
  "relative after:content-[''] after:rounded-xs after:absolute after:left-0 after:bottom-1 after:w-full after:h-[4px] after:bg-[#D43458] after:[box-shadow:0_0_10px_#D43458,0_0_20px_#D43458]";
---

<header>
  <nav class="border-gray-200 px-4 lg:px-8 py-10">
    <h1
      class="self-center tracking-wide text-3xl mb-3 whitespace-nowrap dark:text-white"
    >
      Main Menu
    </h1>
    <span
      id="header-home-info"
      class="text-gray-800 opacity-80 dark:text-white font-medium text-base px-4 lg:px-8 py-2 lg:py-2.5 mr-2 fixed top-10 right-12 bg-gray-700 focus:outline-none"
      >Hector Robayo</span
    >
    <div class="flex flex-wrap items-center max-w-screen-md">
      <Image src={lb} alt={"left border"} class="hidden lg:block w-9 mr-3" />
      <Separator size={6} additionalClass="mb-[-6px]" />
      <a href="/" class:list={["px-4", path === "/" ? redNeonBorder : ""]}>
        <Image
          class:list={[
            "mt-3 mx-auto w-8 hover:opacity-100 sm:w-7 mb-2 ",
            path === "/" ? "opacity-100" : "opacity-50",
          ]}
          src={profile}
          alt={"profile"}
        />
      </a>
      <Separator size={6} additionalClass="mb-[-6px]" />
      <div class="flex not-sr-only lg:sr-only">
        <button
          id="mobile-menu-button"
          class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
        >
          <span class="sr-only">Open main menu</span>
          <svg
            class="w-6 h-6"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              fill-rule="evenodd"
              d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
              clip-rule="evenodd"></path></svg
          >
          <svg
            class="hidden w-6 h-6"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
            ><path
              fill-rule="evenodd"
              d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
              clip-rule="evenodd"></path></svg
          >
        </button>
      </div>
      <div
        class={`hidden justify-between items-center w-full lg:contents lg:w-max`}
        id="mobile-menu"
      >
        <ul
          class="flex flex-col mt-4 font-medium items-center lg:flex-row lg:space-x-8 lg:mt-0"
        >
          <li
            class:list={[
              "mr-0 px-6 py-3",
              path === "/knowledges" ? redNeonBorder : "",
            ]}
          >
            <a
              href="/knowledges"
              class="block py-2 pr-4 pl-3 text-gray-700 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700"
              >Knowledges</a
            >
          </li>
          <Separator size={6} additionalClass="mb-[-6px] mr-0" />
          <li
            class:list={[
              "mr-0 px-6 py-3",
              path === "/experiences" ? redNeonBorder : "",
            ]}
          >
            <a
              href="experiences"
              class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700"
              >experiences</a
            >
          </li>
          <Separator size={6} additionalClass="mb-[-6px] mr-0" />
          <li
            class:list={[
              "mr-0 px-6 py-3",
              path === "/learning" ? redNeonBorder : "",
            ]}
          >
            <a
              href="/learning"
              class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700"
              >Learning</a
            >
          </li>
          <Separator size={6} additionalClass="mb-[-6px] mr-0" />
          <li
            class:list={[
              "mr-0 px-6 py-3",
              path === "/contact" ? redNeonBorder : "",
            ]}
          >
            <a
              href="/contact"
              class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700"
              >Contact me</a
            >
          </li>
          <Separator size={6} additionalClass="mb-[-6px] mr-0" />
        </ul>
      </div>

      <Image src={rb} alt={"right border"} class="hidden lg:block w-9 ml-3" />
    </div>
  </nav>
</header>

<script>
  function handleClick() {
    const mobileMenu = document.getElementById("mobile-menu");
    mobileMenu && mobileMenu.classList.toggle("hidden");
  }
  const mobileMenuButton = document.getElementById("mobile-menu-button");
  mobileMenuButton && mobileMenuButton.addEventListener("click", handleClick);

  function changeHeader(path: string) {
    const pathName = path.split("/")[1];
    const headerHomeInfo = document.getElementById("header-home-info");
    headerHomeInfo && (headerHomeInfo.textContent = pathName || "About me");
  }
  window.addEventListener("popstate", () =>
    changeHeader(window.location.pathname)
  );
  window.addEventListener("pushstate", () =>
    changeHeader(window.location.pathname)
  );
</script>
